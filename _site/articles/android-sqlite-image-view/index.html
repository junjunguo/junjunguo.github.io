<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Android ListView Image save data in SQLite Database &#8211; GuoJunjun's Tech Blog</title>
<meta name="description" content="Choose Image from Gallery or Camera, display in a ListView and save information in SQLite">
<meta name="keywords" content="Android, code, GUI, Java, Mobile, SQLite, Database, XML, image">


<!-- Twitter Cards -->
<meta name="twitter:title" content="Android ListView Image save data in SQLite Database">
<meta name="twitter:description" content="Choose Image from Gallery or Camera, display in a ListView and save information in SQLite">



<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="/images/14786764996_9633596f4e_o.jpg">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Android ListView Image save data in SQLite Database">
<meta property="og:description" content="Choose Image from Gallery or Camera, display in a ListView and save information in SQLite">
<meta property="og:url" content="/articles/android-sqlite-image-view/">
<meta property="og:site_name" content="GuoJunjun's Tech Blog">


<meta name="msvalidate.01" content="5CBE5B96A4448FF4606A09686D87D9D5">


<link rel="canonical" href="/articles/android-sqlite-image-view/">
<link href="./feed.xml" type="application/atom+xml" rel="alternate" title="GuoJunjun's Tech Blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="./assets/css/main.css">
<!-- Webfonts -->
<script src="//use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="./assets/js/vendor/html5shiv.min.js"></script>
  <script src="./assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="./assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="./favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="./favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="./images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="./images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="./images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="./images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
      
		    
		    <li><a href="/tech.html" >Latest</a></li>
		  
		    
		    <li><a href="/blog/" >Blog</a></li>
		  
		    
		    <li><a href="/tags/" >Tags</a></li>
		  
		    
		    <li><a href="/search/" >Search</a></li>
		  
		    
		    <li><a href="/index.html" >About</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<header class="masthead">
	
		<div class="wrap">
			<a href="/" class="site-logo" rel="home" title="GuoJunjun's Tech Blog"><img src="./images/site-logo.png" width="200" height="200" alt="GuoJunjun's Tech Blog logo" class="animated bounceInDown"></a>
		</div>
	
</header><!-- /.masthead -->


<div class="js-menu-screen menu-screen"></div>

<div id="main" role="main">
  <article class="hentry">
    <img src="/images/14786764996_9633596f4e_o.jpg" class="entry-feature-image" alt="Android ListView Image save data in SQLite Database" ><p class="image-credit">Photo Credit: <a href="https://junjunguo.github.io">GuoJunjun</a>
    <div class="entry-wrapper">
      <header class="entry-header">
        <span class="entry-tags"><a href="/tags/#Android" title="Pages tagged Android">Android</a>&nbsp;&bull;&nbsp;<a href="/tags/#code" title="Pages tagged code">code</a>&nbsp;&bull;&nbsp;<a href="/tags/#GUI" title="Pages tagged GUI">GUI</a>&nbsp;&bull;&nbsp;<a href="/tags/#Java" title="Pages tagged Java">Java</a>&nbsp;&bull;&nbsp;<a href="/tags/#Mobile" title="Pages tagged Mobile">Mobile</a>&nbsp;&bull;&nbsp;<a href="/tags/#SQLite" title="Pages tagged SQLite">SQLite</a>&nbsp;&bull;&nbsp;<a href="/tags/#Database" title="Pages tagged Database">Database</a>&nbsp;&bull;&nbsp;<a href="/tags/#XML" title="Pages tagged XML">XML</a>&nbsp;&bull;&nbsp;<a href="/tags/#image" title="Pages tagged image">image</a></span>
        
          <h1 class="entry-title">Android ListView Image save data in SQLite Database</h1>
        
      </header>
      <footer class="entry-meta">
        
        
          <img src="/images/bio-photo.jpg" class="bio-photo" alt="GuoJunjun bio photo"></a>
        
        <span class="author vcard">By <span class="fn">GuoJunjun</span></span>
        <span class="entry-date date published"><time datetime="2015-03-23T00:00:00+01:00"><i class="fa fa-calendar-o"></i> March 23, 2015</time></span>
        
        <span class="entry-comments"><i class="fa fa-comment-o"></i> <a href="#disqus_thread">Comment</a></span>
        <span class="social-share-twitter">
  <a href="https://twitter.com/intent/tweet?hashtags=Android,code,GUI,Java,Mobile,SQLite,Database,XML,image&amp;text=Android%20ListView%20Image%20save%20data%20in%20SQLite%20Database&amp;url=/articles/android-sqlite-image-view/" title="Share on Twitter" itemprop="Twitter"><i class="fa fa-twitter-square"></i> Tweet</a>
</span>
<span class="social-share-facebook">
  <a href="https://www.facebook.com/sharer/sharer.php?u=/articles/android-sqlite-image-view/" title="Share on Facebook" itemprop="Facebook"><i class="fa fa-facebook-square"></i> Like</a>
</span>
<span class="social-share-googleplus">
  <a href="https://plus.google.com/share?url=/articles/android-sqlite-image-view/" title="Share on Google Plus" itemprop="GooglePlus"><i class="fa fa-google-plus-square"></i> +1</a>
</span>
<!-- /.social-share -->
        
      </footer>
      <div class="entry-content">
        <h1 class="no_toc" id="contents">Contents</h1>

<ul id="markdown-toc">
  <li><a href="#about" id="markdown-toc-about">About</a>    <ul>
      <li><a href="#structure" id="markdown-toc-structure">Structure</a></li>
      <li><a href="#screen-captures" id="markdown-toc-screen-captures">screen captures</a></li>
    </ul>
  </li>
  <li><a href="#main-activity" id="markdown-toc-main-activity">Main Activity</a></li>
  <li><a href="#displayimage" id="markdown-toc-displayimage">DisplayImage</a></li>
  <li><a href="#imageresizer" id="markdown-toc-imageresizer">ImageResizer</a></li>
  <li><a href="#imageadapter" id="markdown-toc-imageadapter">ImageAdapter</a></li>
  <li><a href="#myimage" id="markdown-toc-myimage">MyImage</a></li>
  <li><a href="#sqliteopenhelper" id="markdown-toc-sqliteopenhelper">SQLiteOpenHelper</a></li>
  <li><a href="#data-access-object" id="markdown-toc-data-access-object">Data Access Object</a></li>
  <li><a href="#mainactivity-xml" id="markdown-toc-mainactivity-xml"><code>MainActivity xml</code></a></li>
  <li><a href="#display-image-layout" id="markdown-toc-display-image-layout"><code>Display Image Layout</code></a></li>
  <li><a href="#custom-dialog-layout" id="markdown-toc-custom-dialog-layout"><code>Custom dialog Layout</code></a></li>
  <li><a href="#custom-item-layout" id="markdown-toc-custom-item-layout"><code>Custom item Layout</code></a></li>
  <li><a href="#stringsxml" id="markdown-toc-stringsxml"><code>strings.xml</code></a></li>
  <li><a href="#colorsxml" id="markdown-toc-colorsxml"><code>colors.xml</code></a></li>
  <li><a href="#androidmanifestxml" id="markdown-toc-androidmanifestxml"><code>AndroidManifest.xml</code></a></li>
  <li><a href="#references" id="markdown-toc-references">References:</a></li>
</ul>

<h1 id="about">About</h1>

<ul>
  <li>How to create a ListView and use custom item layout in each ListView row?</li>
  <li>How to show a Thumbnail with description in each ListView’s item?</li>
  <li>How to show a image in full screen when the Thumbnail is clicked in ListView?</li>
  <li>How to create a popup window for options choose?</li>
  <li>How to choose a image from gallery and use it in the app?</li>
  <li>How to take a photo and use the photo in the app?</li>
  <li>How to use SQLite Database to save information?</li>
</ul>

<h2 id="structure">Structure</h2>
<p>All will be answered and implemented as following structure:</p>

<h3 id="view--controller">View &amp; Controller</h3>

<ul>
  <li>create a ListView in main window which include:
    <ul>
      <li><code>ThumbnailUtils</code> is used to build a Thumbnail for list view.</li>
      <li>custom <code>item_image.xml</code> to create a custom item view for ListView: Thumbnail at left side and description at the
  right side.</li>
    </ul>
  </li>
  <li>Use Dialog to build a Dialog box (popup window):
    <ul>
      <li>option 1: take a photo (photo will be saved in gallery folder, and add Thumbnail, image information and image
  path to ListView).</li>
      <li>option 2: choose existing photo from gallery.</li>
    </ul>
  </li>
  <li>create a ImageView window (<code>DisplayImage</code>) to show image in full screen.
    <ul>
      <li>a delete function to delete image from ListView and database.</li>
      <li>a back button to return ListView.</li>
      <li>a transparent background description text on top of the screen.</li>
    </ul>
  </li>
</ul>

<h3 id="model">Model</h3>

<ul>
  <li>create a <code>MyImage</code> class to hold image information</li>
  <li><code>ImageAdapter</code> extends from an ArrayAdapter: which is used to populating data from ArrayList to ListView.
    <ul>
      <li>A ViewHolder pattern is used to speed up ListView, smoother and faster item loading.</li>
    </ul>
  </li>
  <li><code>ImageResizer</code>: used to resize the image.
    <ul>
      <li>a image size can be large, it is wise to load a scaled down version image into memory.
        <ul>
          <li>which can increase performance</li>
          <li>reduce the chance that system out of memory and app crash.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><code>DBhelper</code>: A helper class to manage database creation and version management.</li>
  <li><code>DAOdb</code>: a Data Access Object.
    <ul>
      <li>add, delete … query data operations without exposing details of the database.</li>
    </ul>
  </li>
</ul>

<h2 id="screen-captures">screen captures</h2>

<p>Main view when start</p>

<p><img src="https://raw.githubusercontent.com/junjunguo/android/master/2015/SqliteImage/main.png" alt="screen captures" /></p>

<p>Popup window for options</p>

<p><img src="https://raw.githubusercontent.com/junjunguo/android/master/2015/SqliteImage/dialog.png" alt="screen captures" /></p>

<p>ListView in main window: Portrait View</p>

<p><img src="https://raw.githubusercontent.com/junjunguo/android/master/2015/SqliteImage/listp.png" alt="screen captures" /></p>

<p>ImageView in image view window: Portrait View</p>

<p><img src="https://raw.githubusercontent.com/junjunguo/android/master/2015/SqliteImage/imagep.png" alt="screen captures" /></p>

<p>ListView in main window: Landscape View</p>

<p><img src="https://raw.githubusercontent.com/junjunguo/android/master/2015/SqliteImage/listl.png" alt="screen captures" /></p>

<p>ImageView in image view window: Landscape View</p>

<p><img src="https://raw.githubusercontent.com/junjunguo/android/master/2015/SqliteImage/imagel.png" alt="screen captures" /></p>

<p>Popup window for options: choose photo from gallery, Landscape View</p>

<p><img src="https://raw.githubusercontent.com/junjunguo/android/master/2015/SqliteImage/galleryl.png" alt="screen captures" /></p>

<h1 id="main-activity">Main Activity</h1>

<ul>
  <li>create a DAOdb object</li>
  <li>load data from database</li>
  <li>create MyImage and fill with data</li>
  <li>add MyImage to ArrayList</li>
  <li>A ListView is used to show a vertical list of scrollable items</li>
  <li>ArrayAdapter is used to converts an ArrayList of objects into view items loaded into the ListView container.</li>
  <li>Use Dialog to build a popup window:
    <ul>
      <li>active take a photo:
        <ul>
          <li>deals with: taking pictures with camera in android.</li>
          <li>will move to take photo view (photo be saved in gallery folder, and add Thumbnail, image information and
  image path to ListView).</li>
          <li>save data in database</li>
        </ul>
      </li>
      <li>active from gallery:
        <ul>
          <li>deals with: How to pick an image from gallery for app to use?</li>
          <li>choose existing photo from android image gallery and show thumbnail and image path + image information to
  ListView.</li>
          <li>save data in database</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>ItemClickListener: used to switch screen to <code>DisplayImage</code> window
    <ul>
      <li>send image object as JSON string to Display Image window</li>
    </ul>
  </li>
  <li>save instance state: save “captured image uri”</li>
  <li>restore instance state: when screen rotated …
    <ul>
      <li>when screen rotated at taking photo process, activity is on onCreate lifecycle, which will be build again, so
  we need to get the “captured image uri” information from last process.</li>
      <li>application crashes if it can not get this information.</li>
    </ul>
  </li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="n">ActionBarActivity</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">MyImage</span><span class="o">&gt;</span> <span class="n">images</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">ImageAdapter</span> <span class="n">imageAdapter</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">ListView</span> <span class="n">listView</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Uri</span> <span class="n">mCapturedImageURI</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">RESULT_LOAD_IMAGE</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">REQUEST_IMAGE_CAPTURE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">DAOdb</span> <span class="n">daOdb</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_main</span><span class="o">);</span>

        <span class="c1">// Construct the data source</span>
        <span class="n">images</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">();</span>
        <span class="c1">// Create the adapter to convert the array to views</span>
        <span class="n">imageAdapter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ImageAdapter</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">images</span><span class="o">);</span>
        <span class="c1">// Attach the adapter to a ListView</span>
        <span class="n">listView</span> <span class="o">=</span> <span class="o">(</span><span class="n">ListView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">main_list_view</span><span class="o">);</span>
        <span class="n">listView</span><span class="o">.</span><span class="na">setAdapter</span><span class="o">(</span><span class="n">imageAdapter</span><span class="o">);</span>
        <span class="n">addItemClickListener</span><span class="o">(</span><span class="n">listView</span><span class="o">);</span>
        <span class="n">initDB</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * initialize database</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">initDB</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">daOdb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DAOdb</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="c1">//        add images from database to images ArrayList</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">MyImage</span> <span class="n">mi</span> <span class="o">:</span> <span class="n">daOdb</span><span class="o">.</span><span class="na">getImages</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">images</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">mi</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">btnAddOnClick</span><span class="o">(</span><span class="n">View</span> <span class="n">view</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">final</span> <span class="n">Dialog</span> <span class="n">dialog</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Dialog</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="n">dialog</span><span class="o">.</span><span class="na">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">custom_dialog_box</span><span class="o">);</span>
        <span class="n">dialog</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&quot;Alert Dialog View&quot;</span><span class="o">);</span>
        <span class="n">Button</span> <span class="n">btnExit</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span> <span class="n">dialog</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">btnExit</span><span class="o">);</span>
        <span class="n">btnExit</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">dialog</span><span class="o">.</span><span class="na">dismiss</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">});</span>
        <span class="n">dialog</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">btnChoosePath</span><span class="o">)</span>
                <span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
                    <span class="nd">@Override</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">activeGallery</span><span class="o">();</span>
                    <span class="o">}</span>
                <span class="o">});</span>
        <span class="n">dialog</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">btnTakePhoto</span><span class="o">)</span>
                <span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
                    <span class="nd">@Override</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">activeTakePhoto</span><span class="o">();</span>
                    <span class="o">}</span>
                <span class="o">});</span>

        <span class="c1">// show dialog on screen</span>
        <span class="n">dialog</span><span class="o">.</span><span class="na">show</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * take a photo</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">activeTakePhoto</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">Intent</span> <span class="n">takePictureIntent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">MediaStore</span><span class="o">.</span><span class="na">ACTION_IMAGE_CAPTURE</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">takePictureIntent</span><span class="o">.</span><span class="na">resolveActivity</span><span class="o">(</span><span class="n">getPackageManager</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">fileName</span> <span class="o">=</span> <span class="s">&quot;temp.jpg&quot;</span><span class="o">;</span>
            <span class="n">ContentValues</span> <span class="n">values</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ContentValues</span><span class="o">();</span>
            <span class="n">values</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">MediaStore</span><span class="o">.</span><span class="na">Images</span><span class="o">.</span><span class="na">Media</span><span class="o">.</span><span class="na">TITLE</span><span class="o">,</span> <span class="n">fileName</span><span class="o">);</span>
            <span class="n">mCapturedImageURI</span> <span class="o">=</span> <span class="n">getContentResolver</span><span class="o">()</span>
                    <span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="n">MediaStore</span><span class="o">.</span><span class="na">Images</span><span class="o">.</span><span class="na">Media</span><span class="o">.</span><span class="na">EXTERNAL_CONTENT_URI</span><span class="o">,</span>
                            <span class="n">values</span><span class="o">);</span>
            <span class="n">takePictureIntent</span>
                    <span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">MediaStore</span><span class="o">.</span><span class="na">EXTRA_OUTPUT</span><span class="o">,</span> <span class="n">mCapturedImageURI</span><span class="o">);</span>
            <span class="n">startActivityForResult</span><span class="o">(</span><span class="n">takePictureIntent</span><span class="o">,</span> <span class="n">REQUEST_IMAGE_CAPTURE</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * to gallery</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">activeGallery</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">Intent</span><span class="o">.</span><span class="na">ACTION_PICK</span><span class="o">,</span>
                <span class="n">android</span><span class="o">.</span><span class="na">provider</span><span class="o">.</span><span class="na">MediaStore</span><span class="o">.</span><span class="na">Images</span><span class="o">.</span><span class="na">Media</span><span class="o">.</span><span class="na">EXTERNAL_CONTENT_URI</span><span class="o">);</span>
        <span class="n">startActivityForResult</span><span class="o">(</span><span class="n">intent</span><span class="o">,</span> <span class="n">RESULT_LOAD_IMAGE</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span> <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onActivityResult</span><span class="o">(</span><span class="kt">int</span> <span class="n">requestCode</span><span class="o">,</span> <span class="kt">int</span> <span class="n">resultCode</span><span class="o">,</span>
            <span class="n">Intent</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onActivityResult</span><span class="o">(</span><span class="n">requestCode</span><span class="o">,</span> <span class="n">resultCode</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span>
        <span class="k">switch</span> <span class="o">(</span><span class="n">requestCode</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">case</span> <span class="n">RESULT_LOAD_IMAGE</span><span class="o">:</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">requestCode</span> <span class="o">==</span> <span class="n">RESULT_LOAD_IMAGE</span> <span class="o">&amp;&amp;</span>
                        <span class="n">resultCode</span> <span class="o">==</span> <span class="n">RESULT_OK</span> <span class="o">&amp;&amp;</span> <span class="kc">null</span> <span class="o">!=</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">Uri</span> <span class="n">selectedImage</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getData</span><span class="o">();</span>
                    <span class="n">String</span><span class="o">[]</span> <span class="n">filePathColumn</span> <span class="o">=</span> <span class="o">{</span><span class="n">MediaStore</span><span class="o">.</span><span class="na">Images</span><span class="o">.</span><span class="na">Media</span><span class="o">.</span><span class="na">DATA</span><span class="o">};</span>
                    <span class="n">Cursor</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">getContentResolver</span><span class="o">()</span>
                            <span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="n">selectedImage</span><span class="o">,</span> <span class="n">filePathColumn</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span>
                                    <span class="kc">null</span><span class="o">);</span>
                    <span class="n">cursor</span><span class="o">.</span><span class="na">moveToFirst</span><span class="o">();</span>
                    <span class="kt">int</span> <span class="n">columnIndex</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="na">getColumnIndex</span><span class="o">(</span><span class="n">filePathColumn</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
                    <span class="n">String</span> <span class="n">picturePath</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">columnIndex</span><span class="o">);</span>
                    <span class="n">cursor</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
                    <span class="n">MyImage</span> <span class="n">image</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyImage</span><span class="o">();</span>
                    <span class="n">image</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&quot;Test&quot;</span><span class="o">);</span>
                    <span class="n">image</span><span class="o">.</span><span class="na">setDescription</span><span class="o">(</span>
                            <span class="s">&quot;test choose a photo from gallery and add it to &quot;</span> <span class="o">+</span>
                                    <span class="s">&quot;list view&quot;</span><span class="o">);</span>
                    <span class="n">image</span><span class="o">.</span><span class="na">setDatetime</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
                    <span class="n">image</span><span class="o">.</span><span class="na">setPath</span><span class="o">(</span><span class="n">picturePath</span><span class="o">);</span>
                    <span class="n">images</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">image</span><span class="o">);</span>
                    <span class="n">daOdb</span><span class="o">.</span><span class="na">addImage</span><span class="o">(</span><span class="n">image</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="k">case</span> <span class="n">REQUEST_IMAGE_CAPTURE</span><span class="o">:</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">requestCode</span> <span class="o">==</span> <span class="n">REQUEST_IMAGE_CAPTURE</span> <span class="o">&amp;&amp;</span>
                        <span class="n">resultCode</span> <span class="o">==</span> <span class="n">RESULT_OK</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">String</span><span class="o">[]</span> <span class="n">projection</span> <span class="o">=</span> <span class="o">{</span><span class="n">MediaStore</span><span class="o">.</span><span class="na">Images</span><span class="o">.</span><span class="na">Media</span><span class="o">.</span><span class="na">DATA</span><span class="o">};</span>
                    <span class="n">Cursor</span> <span class="n">cursor</span> <span class="o">=</span>
                            <span class="n">managedQuery</span><span class="o">(</span><span class="n">mCapturedImageURI</span><span class="o">,</span> <span class="n">projection</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span>
                                    <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
                    <span class="kt">int</span> <span class="n">column_index_data</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="na">getColumnIndexOrThrow</span><span class="o">(</span>
                            <span class="n">MediaStore</span><span class="o">.</span><span class="na">Images</span><span class="o">.</span><span class="na">Media</span><span class="o">.</span><span class="na">DATA</span><span class="o">);</span>
                    <span class="n">cursor</span><span class="o">.</span><span class="na">moveToFirst</span><span class="o">();</span>
                    <span class="n">String</span> <span class="n">picturePath</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">column_index_data</span><span class="o">);</span>
                    <span class="n">MyImage</span> <span class="n">image</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyImage</span><span class="o">();</span>
                    <span class="n">image</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&quot;Test&quot;</span><span class="o">);</span>
                    <span class="n">image</span><span class="o">.</span><span class="na">setDescription</span><span class="o">(</span>
                            <span class="s">&quot;test take a photo and add it to list view&quot;</span><span class="o">);</span>
                    <span class="n">image</span><span class="o">.</span><span class="na">setDatetime</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
                    <span class="n">image</span><span class="o">.</span><span class="na">setPath</span><span class="o">(</span><span class="n">picturePath</span><span class="o">);</span>
                    <span class="n">images</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">image</span><span class="o">);</span>
                    <span class="n">daOdb</span><span class="o">.</span><span class="na">addImage</span><span class="o">(</span><span class="n">image</span><span class="o">);</span>
                <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * item clicked listener used to implement the react action when an item is</span>
<span class="cm">     * clicked.</span>
<span class="cm">     *</span>
<span class="cm">     * @param listView</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">addItemClickListener</span><span class="o">(</span><span class="kd">final</span> <span class="n">ListView</span> <span class="n">listView</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">listView</span><span class="o">.</span><span class="na">setOnItemClickListener</span><span class="o">(</span><span class="k">new</span> <span class="n">OnItemClickListener</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onItemClick</span><span class="o">(</span><span class="n">AdapterView</span><span class="o">&lt;?&gt;</span> <span class="n">parent</span><span class="o">,</span> <span class="n">View</span> <span class="n">view</span><span class="o">,</span>
                    <span class="kt">int</span> <span class="n">position</span><span class="o">,</span> <span class="kt">long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>

                <span class="n">MyImage</span> <span class="n">image</span> <span class="o">=</span> <span class="o">(</span><span class="n">MyImage</span><span class="o">)</span> <span class="n">listView</span><span class="o">.</span><span class="na">getItemAtPosition</span><span class="o">(</span><span class="n">position</span><span class="o">);</span>
                <span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span>
                        <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">getBaseContext</span><span class="o">(),</span> <span class="n">DisplayImage</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
                <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="s">&quot;IMAGE&quot;</span><span class="o">,</span> <span class="o">(</span><span class="k">new</span> <span class="n">Gson</span><span class="o">()).</span><span class="na">toJson</span><span class="o">(</span><span class="n">image</span><span class="o">));</span>
                <span class="n">startActivity</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">});</span>
    <span class="o">}</span>

    <span class="nd">@Override</span> <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onSaveInstanceState</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">outState</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Save the user&#39;s current game state</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">mCapturedImageURI</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">outState</span><span class="o">.</span><span class="na">putString</span><span class="o">(</span><span class="s">&quot;mCapturedImageURI&quot;</span><span class="o">,</span>
                    <span class="n">mCapturedImageURI</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="c1">// Always call the superclass so it can save the view hierarchy state</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onSaveInstanceState</span><span class="o">(</span><span class="n">outState</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span> <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onRestoreInstanceState</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Always call the superclass so it can restore the view hierarchy</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onRestoreInstanceState</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>

        <span class="c1">// Restore state members from saved instance</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">savedInstanceState</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="s">&quot;mCapturedImageURI&quot;</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">mCapturedImageURI</span> <span class="o">=</span> <span class="n">Uri</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span>
                    <span class="n">savedInstanceState</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;mCapturedImageURI&quot;</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h1 id="displayimage">DisplayImage</h1>
<p>Display the selected item’s image in full screen.</p>
<ul>
  <li>use: save instance and restore instance to handle screen rotation …</li>
  <li>restore image object from JSON string.
    <ul>
      <li>use the image information to show the selected image and its description.</li>
    </ul>
  </li>
  <li>use <code>ImageResizer</code> to resize the image</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DisplayImage</span> <span class="kd">extends</span> <span class="n">Activity</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">MyImage</span> <span class="n">image</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">ImageView</span> <span class="n">imageView</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">TextView</span> <span class="n">description</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">jstring</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_display_image</span><span class="o">);</span>
        <span class="n">imageView</span> <span class="o">=</span> <span class="o">(</span><span class="n">ImageView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">display_image_view</span><span class="o">);</span>
        <span class="n">description</span> <span class="o">=</span> <span class="o">(</span><span class="n">TextView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">text_view_description</span><span class="o">);</span>
        <span class="n">Bundle</span> <span class="n">extras</span> <span class="o">=</span> <span class="n">getIntent</span><span class="o">().</span><span class="na">getExtras</span><span class="o">();</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">extras</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">jstring</span> <span class="o">=</span> <span class="n">extras</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;IMAGE&quot;</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">getMyImage</span><span class="o">(</span><span class="n">jstring</span><span class="o">);</span>
        <span class="n">description</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">image</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="n">Display</span> <span class="n">display</span> <span class="o">=</span> <span class="n">getWindowManager</span><span class="o">().</span><span class="na">getDefaultDisplay</span><span class="o">();</span>
        <span class="n">Point</span> <span class="n">size</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Point</span><span class="o">();</span>
        <span class="n">display</span><span class="o">.</span><span class="na">getSize</span><span class="o">(</span><span class="n">size</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">width</span> <span class="o">=</span> <span class="n">size</span><span class="o">.</span><span class="na">x</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">height</span> <span class="o">=</span> <span class="n">size</span><span class="o">.</span><span class="na">y</span><span class="o">;</span>
        <span class="n">imageView</span><span class="o">.</span><span class="na">setImageBitmap</span><span class="o">(</span><span class="n">ImageResizer</span>
                <span class="o">.</span><span class="na">decodeSampledBitmapFromFile</span><span class="o">(</span><span class="n">image</span><span class="o">.</span><span class="na">getPath</span><span class="o">(),</span> <span class="n">width</span><span class="o">,</span> <span class="n">height</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="n">MyImage</span> <span class="nf">getMyImage</span><span class="o">(</span><span class="n">String</span> <span class="n">image</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">JSONObject</span> <span class="n">job</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">(</span><span class="n">image</span><span class="o">);</span>
            <span class="k">return</span> <span class="o">(</span><span class="k">new</span> <span class="n">MyImage</span><span class="o">(</span><span class="n">job</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;title&quot;</span><span class="o">),</span>
                    <span class="n">job</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;description&quot;</span><span class="o">),</span> <span class="n">job</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;path&quot;</span><span class="o">),</span>
                    <span class="n">job</span><span class="o">.</span><span class="na">getLong</span><span class="o">(</span><span class="s">&quot;datetimeLong&quot;</span><span class="o">)));</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">JSONException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * go back to main activity</span>
<span class="cm">     *</span>
<span class="cm">     * @param v</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">btnBackOnClick</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">startActivity</span><span class="o">(</span><span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">MainActivity</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
        <span class="n">finish</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * delete the current item;</span>
<span class="cm">     *</span>
<span class="cm">     * @param v</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">btnDeleteOnClick</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">DAOdb</span> <span class="n">db</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DAOdb</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="n">db</span><span class="o">.</span><span class="na">deleteImage</span><span class="o">(</span><span class="n">image</span><span class="o">);</span>
        <span class="n">db</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">startActivity</span><span class="o">(</span><span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">MainActivity</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
        <span class="n">finish</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Override</span> <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onSaveInstanceState</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">outState</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Save the user&#39;s current game state</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">jstring</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">outState</span><span class="o">.</span><span class="na">putString</span><span class="o">(</span><span class="s">&quot;jstring&quot;</span><span class="o">,</span> <span class="n">jstring</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">// Always call the superclass so it can save the view hierarchy state</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onSaveInstanceState</span><span class="o">(</span><span class="n">outState</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span> <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onRestoreInstanceState</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Always call the superclass so it can restore the view hierarchy</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onRestoreInstanceState</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>

        <span class="c1">// Restore state members from saved instance</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">savedInstanceState</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="s">&quot;jstring&quot;</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">jstring</span> <span class="o">=</span> <span class="n">savedInstanceState</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;jstring&quot;</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h1 id="imageresizer">ImageResizer</h1>
<p>resize images by give a target width and height. Useful for when the input images might be too large to simply load
directly into memory.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ImageResizer</span> <span class="o">{</span>

    <span class="cm">/**</span>
<span class="cm">     * Calculate an inSampleSize for use in a {@link android.graphics</span>
<span class="cm">     * .BitmapFactory.Options} object when decoding bitmaps using the decode*</span>
<span class="cm">     * methods from {@link android.graphics.BitmapFactory}. This implementation</span>
<span class="cm">     * calculates the closest inSampleSize that is a power of 2 and will result</span>
<span class="cm">     * in the final decoded bitmap having a width and height equal to or larger</span>
<span class="cm">     * than the requested width and height.</span>
<span class="cm">     *</span>
<span class="cm">     * @param options   An options object with out* params already populated</span>
<span class="cm">     *                  (run through a decode* method with</span>
<span class="cm">     *                  inJustDecodeBounds==true</span>
<span class="cm">     * @param reqWidth  The requested width of the resulting bitmap</span>
<span class="cm">     * @param reqHeight The requested height of the resulting bitmap</span>
<span class="cm">     * @return The value to be used for inSampleSize</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">calculateInSampleSize</span><span class="o">(</span><span class="n">BitmapFactory</span><span class="o">.</span><span class="na">Options</span> <span class="n">options</span><span class="o">,</span>
            <span class="kt">int</span> <span class="n">reqWidth</span><span class="o">,</span> <span class="kt">int</span> <span class="n">reqHeight</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Raw height and width of image</span>
        <span class="kd">final</span> <span class="kt">int</span> <span class="n">height</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="na">outHeight</span><span class="o">;</span>
        <span class="kd">final</span> <span class="kt">int</span> <span class="n">width</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="na">outWidth</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">inSampleSize</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">height</span> <span class="o">&gt;</span> <span class="n">reqHeight</span> <span class="o">||</span> <span class="n">width</span> <span class="o">&gt;</span> <span class="n">reqWidth</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">final</span> <span class="kt">int</span> <span class="n">halfHeight</span> <span class="o">=</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="o">;</span>
            <span class="kd">final</span> <span class="kt">int</span> <span class="n">halfWidth</span> <span class="o">=</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="o">;</span>

            <span class="c1">// Calculate the largest inSampleSize value that is a power of 2</span>
            <span class="c1">// and keeps both height and width larger than the requested</span>
            <span class="c1">// height and width.</span>
            <span class="k">while</span> <span class="o">((</span><span class="n">halfHeight</span> <span class="o">/</span> <span class="n">inSampleSize</span><span class="o">)</span> <span class="o">&gt;</span> <span class="n">reqHeight</span> <span class="o">&amp;&amp;</span>
                    <span class="o">(</span><span class="n">halfWidth</span> <span class="o">/</span> <span class="n">inSampleSize</span><span class="o">)</span> <span class="o">&gt;</span> <span class="n">reqWidth</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">inSampleSize</span> <span class="o">*=</span> <span class="mi">2</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">inSampleSize</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Decode and sample down a bitmap from a file to the requested width and</span>
<span class="cm">     * height.</span>
<span class="cm">     *</span>
<span class="cm">     * @param filename  The full path of the file to decode</span>
<span class="cm">     * @param reqWidth  The requested width of the resulting bitmap</span>
<span class="cm">     * @param reqHeight The requested height of the resulting bitmap</span>
<span class="cm">     * @return A bitmap sampled down from the original with the same aspect</span>
<span class="cm">     * ratio and dimensions that are equal to or greater than the requested</span>
<span class="cm">     * width and height</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Bitmap</span> <span class="nf">decodeSampledBitmapFromFile</span><span class="o">(</span><span class="n">String</span> <span class="n">filename</span><span class="o">,</span>
            <span class="kt">int</span> <span class="n">reqWidth</span><span class="o">,</span> <span class="kt">int</span> <span class="n">reqHeight</span><span class="o">)</span> <span class="o">{</span>

        <span class="c1">// First decode with inJustDecodeBounds=true to check dimensions</span>
        <span class="kd">final</span> <span class="n">BitmapFactory</span><span class="o">.</span><span class="na">Options</span> <span class="n">options</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BitmapFactory</span><span class="o">.</span><span class="na">Options</span><span class="o">();</span>
        <span class="n">options</span><span class="o">.</span><span class="na">inJustDecodeBounds</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
        <span class="n">BitmapFactory</span><span class="o">.</span><span class="na">decodeFile</span><span class="o">(</span><span class="n">filename</span><span class="o">,</span> <span class="n">options</span><span class="o">);</span>

        <span class="c1">// Calculate inSampleSize</span>
        <span class="n">options</span><span class="o">.</span><span class="na">inSampleSize</span> <span class="o">=</span>
                <span class="n">calculateInSampleSize</span><span class="o">(</span><span class="n">options</span><span class="o">,</span> <span class="n">reqWidth</span><span class="o">,</span> <span class="n">reqHeight</span><span class="o">);</span>

        <span class="c1">// Decode bitmap with inSampleSize set</span>
        <span class="n">options</span><span class="o">.</span><span class="na">inJustDecodeBounds</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">BitmapFactory</span><span class="o">.</span><span class="na">decodeFile</span><span class="o">(</span><span class="n">filename</span><span class="o">,</span> <span class="n">options</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h1 id="imageadapter">ImageAdapter</h1>
<p>ArrayAdapter is used to converts an ArrayList of objects into view items loaded into the ListView container.</p>

<ul>
  <li>A ViewHolder pattern is used to speed up ListView, smoother and faster item loading.</li>
  <li><code>ThumbnailUtils</code> is used to build a Thumbnail for list view.</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ImageAdapter</span> <span class="kd">extends</span> <span class="n">ArrayAdapter</span><span class="o">&lt;</span><span class="n">MyImage</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">THUMBSIZE</span> <span class="o">=</span> <span class="mi">96</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">     * applying ViewHolder pattern to speed up ListView, smoother and faster</span>
<span class="cm">     * item loading by caching view in A ViewHolder object</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">ViewHolder</span> <span class="o">{</span>
        <span class="n">ImageView</span> <span class="n">imgIcon</span><span class="o">;</span>
        <span class="n">TextView</span> <span class="n">description</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">ImageAdapter</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">MyImage</span><span class="o">&gt;</span> <span class="n">images</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">images</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span> <span class="kd">public</span> <span class="n">View</span> <span class="nf">getView</span><span class="o">(</span><span class="kt">int</span> <span class="n">position</span><span class="o">,</span> <span class="n">View</span> <span class="n">convertView</span><span class="o">,</span>
            <span class="n">ViewGroup</span> <span class="n">parent</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// view lookup cache stored in tag</span>
        <span class="n">ViewHolder</span> <span class="n">viewHolder</span><span class="o">;</span>
        <span class="c1">// Check if an existing view is being reused, otherwise inflate the</span>
        <span class="c1">// item view</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">convertView</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">viewHolder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ViewHolder</span><span class="o">();</span>
            <span class="n">convertView</span> <span class="o">=</span> <span class="n">LayoutInflater</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">getContext</span><span class="o">())</span>
                    <span class="o">.</span><span class="na">inflate</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">item_image</span><span class="o">,</span> <span class="n">parent</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
            <span class="n">viewHolder</span><span class="o">.</span><span class="na">description</span> <span class="o">=</span>
                    <span class="o">(</span><span class="n">TextView</span><span class="o">)</span> <span class="n">convertView</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">item_img_infor</span><span class="o">);</span>
            <span class="n">viewHolder</span><span class="o">.</span><span class="na">imgIcon</span> <span class="o">=</span>
                    <span class="o">(</span><span class="n">ImageView</span><span class="o">)</span> <span class="n">convertView</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">item_img_icon</span><span class="o">);</span>
            <span class="n">convertView</span><span class="o">.</span><span class="na">setTag</span><span class="o">(</span><span class="n">viewHolder</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">viewHolder</span> <span class="o">=</span> <span class="o">(</span><span class="n">ViewHolder</span><span class="o">)</span> <span class="n">convertView</span><span class="o">.</span><span class="na">getTag</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="c1">// Get the data item for this position</span>
        <span class="n">MyImage</span> <span class="n">image</span> <span class="o">=</span> <span class="n">getItem</span><span class="o">(</span><span class="n">position</span><span class="o">);</span>
        <span class="c1">// set description text</span>
        <span class="n">viewHolder</span><span class="o">.</span><span class="na">description</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">image</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="c1">// set image icon</span>
        <span class="n">viewHolder</span><span class="o">.</span><span class="na">imgIcon</span><span class="o">.</span><span class="na">setImageBitmap</span><span class="o">(</span><span class="n">ThumbnailUtils</span>
                <span class="o">.</span><span class="na">extractThumbnail</span><span class="o">(</span><span class="n">BitmapFactory</span><span class="o">.</span><span class="na">decodeFile</span><span class="o">(</span><span class="n">image</span><span class="o">.</span><span class="na">getPath</span><span class="o">()),</span>
                        <span class="n">THUMBSIZE</span><span class="o">,</span> <span class="n">THUMBSIZE</span><span class="o">));</span>

        <span class="c1">// Return the completed view to render on screen</span>
        <span class="k">return</span> <span class="n">convertView</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h1 id="myimage">MyImage</h1>

<p>holder image’s information.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyImage</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">title</span><span class="o">,</span> <span class="n">description</span><span class="o">,</span> <span class="n">path</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">datetimeLong</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">SimpleDateFormat</span> <span class="n">df</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SimpleDateFormat</span><span class="o">(</span><span class="s">&quot;MMMM d, yy  h:mm&quot;</span><span class="o">);</span>

    <span class="kd">public</span> <span class="nf">MyImage</span><span class="o">(</span><span class="n">String</span> <span class="n">title</span><span class="o">,</span> <span class="n">String</span> <span class="n">description</span><span class="o">,</span> <span class="n">String</span> <span class="n">path</span><span class="o">,</span>
            <span class="kt">long</span> <span class="n">datetimeLong</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">description</span> <span class="o">=</span> <span class="n">description</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">path</span> <span class="o">=</span> <span class="n">path</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">datetimeLong</span> <span class="o">=</span> <span class="n">datetimeLong</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">MyImage</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Gets title.</span>
<span class="cm">     *</span>
<span class="cm">     * @return Value of title.</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTitle</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">title</span><span class="o">;</span> <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Gets datetime.</span>
<span class="cm">     *</span>
<span class="cm">     * @return Value of datetime.</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="n">Calendar</span> <span class="nf">getDatetime</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">Calendar</span> <span class="n">cal</span> <span class="o">=</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
        <span class="n">cal</span><span class="o">.</span><span class="na">setTimeInMillis</span><span class="o">(</span><span class="n">datetimeLong</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">cal</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Sets new datetimeLong.</span>
<span class="cm">     *</span>
<span class="cm">     * @param datetimeLong New value of datetimeLong.</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setDatetime</span><span class="o">(</span><span class="kt">long</span> <span class="n">datetimeLong</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">datetimeLong</span> <span class="o">=</span> <span class="n">datetimeLong</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Sets new datetime.</span>
<span class="cm">     *</span>
<span class="cm">     * @param datetime New value of datetime.</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setDatetime</span><span class="o">(</span><span class="n">Calendar</span> <span class="n">datetime</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">datetimeLong</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="na">getTimeInMillis</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Gets description.</span>
<span class="cm">     *</span>
<span class="cm">     * @return Value of description.</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getDescription</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">description</span><span class="o">;</span> <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Sets new title.</span>
<span class="cm">     *</span>
<span class="cm">     * @param title New value of title.</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setTitle</span><span class="o">(</span><span class="n">String</span> <span class="n">title</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">;</span> <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Gets datetimeLong.</span>
<span class="cm">     *</span>
<span class="cm">     * @return Value of datetimeLong.</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">getDatetimeLong</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">datetimeLong</span><span class="o">;</span> <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Sets new description.</span>
<span class="cm">     *</span>
<span class="cm">     * @param description New value of description.</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setDescription</span><span class="o">(</span><span class="n">String</span> <span class="n">description</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">description</span> <span class="o">=</span> <span class="n">description</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Sets new path.</span>
<span class="cm">     *</span>
<span class="cm">     * @param path New value of path.</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPath</span><span class="o">(</span><span class="n">String</span> <span class="n">path</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">path</span> <span class="o">=</span> <span class="n">path</span><span class="o">;</span> <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Gets path.</span>
<span class="cm">     *</span>
<span class="cm">     * @return Value of path.</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getPath</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">path</span><span class="o">;</span> <span class="o">}</span>

    <span class="nd">@Override</span> <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">&quot;Title:&quot;</span> <span class="o">+</span> <span class="n">title</span> <span class="o">+</span> <span class="s">&quot;   &quot;</span> <span class="o">+</span> <span class="n">df</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="n">getDatetime</span><span class="o">().</span><span class="na">getTime</span><span class="o">())</span> <span class="o">+</span>
                <span class="s">&quot;\nDescription:&quot;</span> <span class="o">+</span> <span class="n">description</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h1 id="sqliteopenhelper">SQLiteOpenHelper</h1>
<p>Extends SQLiteOpenHelper to build a helper class to manage database creation and version management.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DBhelper</span> <span class="kd">extends</span> <span class="n">SQLiteOpenHelper</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">DB_NAME</span> <span class="o">=</span> <span class="s">&quot;sqliteimage.db&quot;</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">DB_VERSION</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">COMMA_SEP</span> <span class="o">=</span> <span class="s">&quot;,&quot;</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">TEXT_TYPE</span> <span class="o">=</span> <span class="s">&quot; TEXT&quot;</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">NUMERIC_TYPE</span> <span class="o">=</span> <span class="s">&quot; NUMERIC&quot;</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">TABLE_NAME</span> <span class="o">=</span> <span class="s">&quot;image&quot;</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">COLUMN_PATH</span> <span class="o">=</span> <span class="s">&quot;path&quot;</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">COLUMN_TITLE</span> <span class="o">=</span> <span class="s">&quot;title&quot;</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">COLUMN_DATETIME</span> <span class="o">=</span> <span class="s">&quot;datetime&quot;</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">COLUMN_DESCRIPTION</span> <span class="o">=</span> <span class="s">&quot;description&quot;</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">PRIMARY_KEY</span> <span class="o">=</span> <span class="s">&quot;PRIMARY KEY (&quot;</span> <span class="o">+</span> <span class="n">COLUMN_TITLE</span> <span class="o">+</span> <span class="s">&quot;,&quot;</span> <span class="o">+</span> <span class="n">COLUMN_DATETIME</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">DELETE_TABLE</span> <span class="o">=</span> <span class="s">&quot;DROP TABLE IF EXISTS &quot;</span> <span class="o">+</span> <span class="n">TABLE_NAME</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">CREATE_TABLE</span> <span class="o">=</span> <span class="s">&quot;CREATE TABLE &quot;</span> <span class="o">+</span> <span class="n">TABLE_NAME</span> <span class="o">+</span> <span class="s">&quot; (&quot;</span> <span class="o">+</span>
            <span class="n">COLUMN_PATH</span> <span class="o">+</span> <span class="n">TEXT_TYPE</span> <span class="o">+</span> <span class="n">COMMA_SEP</span> <span class="o">+</span>
            <span class="n">COLUMN_TITLE</span> <span class="o">+</span> <span class="n">TEXT_TYPE</span> <span class="o">+</span> <span class="n">COMMA_SEP</span> <span class="o">+</span>
            <span class="n">COLUMN_DESCRIPTION</span> <span class="o">+</span> <span class="n">TEXT_TYPE</span> <span class="o">+</span> <span class="n">COMMA_SEP</span> <span class="o">+</span>
            <span class="n">COLUMN_DATETIME</span> <span class="o">+</span> <span class="n">NUMERIC_TYPE</span> <span class="o">+</span> <span class="n">COMMA_SEP</span> <span class="o">+</span>
            <span class="n">PRIMARY_KEY</span> <span class="o">+</span>
            <span class="s">&quot; )&quot;</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">DBhelper</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="n">DB_NAME</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="n">DB_VERSION</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">SQLiteDatabase</span> <span class="n">db</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="n">CREATE_TABLE</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onUpgrade</span><span class="o">(</span><span class="n">SQLiteDatabase</span> <span class="n">db</span><span class="o">,</span> <span class="kt">int</span> <span class="n">oldVersion</span><span class="o">,</span> <span class="kt">int</span> <span class="n">newVersion</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="n">DELETE_TABLE</span><span class="o">);</span>
        <span class="n">onCreate</span><span class="o">(</span><span class="n">db</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h1 id="data-access-object">Data Access Object</h1>
<p>create a <code>DAOdb</code> to handle add, delete, get etc. query data operations with database.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DAOdb</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">SQLiteDatabase</span> <span class="n">database</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">DBhelper</span> <span class="n">dbHelper</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">DAOdb</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">dbHelper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DBhelper</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">dbHelper</span><span class="o">.</span><span class="na">getWritableDatabase</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * close any database object</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">close</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">dbHelper</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * insert a text report item to the location database table</span>
<span class="cm">     *</span>
<span class="cm">     * @param image</span>
<span class="cm">     * @return the row ID of the newly inserted row, or -1 if an error occurred</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">addImage</span><span class="o">(</span><span class="n">MyImage</span> <span class="n">image</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">ContentValues</span> <span class="n">cv</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ContentValues</span><span class="o">();</span>
        <span class="n">cv</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">DBhelper</span><span class="o">.</span><span class="na">COLUMN_PATH</span><span class="o">,</span> <span class="n">image</span><span class="o">.</span><span class="na">getPath</span><span class="o">());</span>
        <span class="n">cv</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">DBhelper</span><span class="o">.</span><span class="na">COLUMN_TITLE</span><span class="o">,</span> <span class="n">image</span><span class="o">.</span><span class="na">getTitle</span><span class="o">());</span>
        <span class="n">cv</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">DBhelper</span><span class="o">.</span><span class="na">COLUMN_DESCRIPTION</span><span class="o">,</span> <span class="n">image</span><span class="o">.</span><span class="na">getDescription</span><span class="o">());</span>
        <span class="n">cv</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">DBhelper</span><span class="o">.</span><span class="na">COLUMN_DATETIME</span><span class="o">,</span> <span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">());</span>
        <span class="k">return</span> <span class="n">database</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="n">DBhelper</span><span class="o">.</span><span class="na">TABLE_NAME</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="n">cv</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * delete the given image from database</span>
<span class="cm">     *</span>
<span class="cm">     * @param image</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteImage</span><span class="o">(</span><span class="n">MyImage</span> <span class="n">image</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">whereClause</span> <span class="o">=</span>
                <span class="n">DBhelper</span><span class="o">.</span><span class="na">COLUMN_TITLE</span> <span class="o">+</span> <span class="s">&quot;=? AND &quot;</span> <span class="o">+</span> <span class="n">DBhelper</span><span class="o">.</span><span class="na">COLUMN_DATETIME</span> <span class="o">+</span>
                        <span class="s">&quot;=?&quot;</span><span class="o">;</span>
        <span class="n">String</span><span class="o">[]</span> <span class="n">whereArgs</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">[]{</span><span class="n">image</span><span class="o">.</span><span class="na">getTitle</span><span class="o">(),</span>
                <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">image</span><span class="o">.</span><span class="na">getDatetimeLong</span><span class="o">())};</span>
        <span class="n">database</span><span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="n">DBhelper</span><span class="o">.</span><span class="na">TABLE_NAME</span><span class="o">,</span> <span class="n">whereClause</span><span class="o">,</span> <span class="n">whereArgs</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * @return all image as a List</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">MyImage</span><span class="o">&gt;</span> <span class="nf">getImages</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">MyImage</span><span class="o">&gt;</span> <span class="n">MyImages</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="n">Cursor</span> <span class="n">cursor</span> <span class="o">=</span>
                <span class="n">database</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="n">DBhelper</span><span class="o">.</span><span class="na">TABLE_NAME</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span>
                        <span class="kc">null</span><span class="o">,</span> <span class="n">DBhelper</span><span class="o">.</span><span class="na">COLUMN_DATETIME</span> <span class="o">+</span> <span class="s">&quot; DESC&quot;</span><span class="o">);</span>
        <span class="n">cursor</span><span class="o">.</span><span class="na">moveToFirst</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(!</span><span class="n">cursor</span><span class="o">.</span><span class="na">isAfterLast</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">MyImage</span> <span class="n">MyImage</span> <span class="o">=</span> <span class="n">cursorToMyImage</span><span class="o">(</span><span class="n">cursor</span><span class="o">);</span>
            <span class="n">MyImages</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">MyImage</span><span class="o">);</span>
            <span class="n">cursor</span><span class="o">.</span><span class="na">moveToNext</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">cursor</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">MyImages</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * read the cursor row and convert the row to a MyImage object</span>
<span class="cm">     *</span>
<span class="cm">     * @param cursor</span>
<span class="cm">     * @return MyImage object</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="n">MyImage</span> <span class="nf">cursorToMyImage</span><span class="o">(</span><span class="n">Cursor</span> <span class="n">cursor</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">MyImage</span> <span class="n">image</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyImage</span><span class="o">();</span>
        <span class="n">image</span><span class="o">.</span><span class="na">setPath</span><span class="o">(</span>
                <span class="n">cursor</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">cursor</span><span class="o">.</span><span class="na">getColumnIndex</span><span class="o">(</span><span class="n">DBhelper</span><span class="o">.</span><span class="na">COLUMN_PATH</span><span class="o">)));</span>
        <span class="n">image</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span>
                <span class="n">cursor</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">cursor</span><span class="o">.</span><span class="na">getColumnIndex</span><span class="o">(</span><span class="n">DBhelper</span><span class="o">.</span><span class="na">COLUMN_TITLE</span><span class="o">)));</span>
        <span class="n">image</span><span class="o">.</span><span class="na">setDatetime</span><span class="o">(</span><span class="n">cursor</span><span class="o">.</span><span class="na">getLong</span><span class="o">(</span>
                <span class="n">cursor</span><span class="o">.</span><span class="na">getColumnIndex</span><span class="o">(</span><span class="n">DBhelper</span><span class="o">.</span><span class="na">COLUMN_DATETIME</span><span class="o">)));</span>
        <span class="n">image</span><span class="o">.</span><span class="na">setDescription</span><span class="o">(</span><span class="n">cursor</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span>
                <span class="n">cursor</span><span class="o">.</span><span class="na">getColumnIndex</span><span class="o">(</span><span class="n">DBhelper</span><span class="o">.</span><span class="na">COLUMN_DESCRIPTION</span><span class="o">)));</span>
        <span class="k">return</span> <span class="n">image</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h1 id="mainactivity-xml"><code>MainActivity xml</code></h1>

<p><code>layout/activity_main.xml</code> has a ListView, and a Button to active Alert Dialog window:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;LinearLayout</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
              <span class="na">xmlns:tools=</span><span class="s">&quot;http://schemas.android.com/tools&quot;</span>
              <span class="na">android:layout_width=</span><span class="s">&quot;match_parent&quot;</span>
              <span class="na">android:layout_height=</span><span class="s">&quot;match_parent&quot;</span>
              <span class="na">android:orientation=</span><span class="s">&quot;vertical&quot;</span>
              <span class="na">tools:context=</span><span class="s">&quot;.MainActivity&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;Button</span>
        <span class="na">android:layout_width=</span><span class="s">&quot;match_parent&quot;</span>
        <span class="na">android:layout_height=</span><span class="s">&quot;50dp&quot;</span>
        <span class="na">android:background=</span><span class="s">&quot;@color/deepPurple4&quot;</span>
        <span class="na">android:textColor=</span><span class="s">&quot;@color/white&quot;</span>
        <span class="na">android:id=</span><span class="s">&quot;@+id/btnAdd&quot;</span>
        <span class="na">android:onClick=</span><span class="s">&quot;btnAddOnClick&quot;</span>
        <span class="na">android:text=</span><span class="s">&quot;@string/add_image&quot;</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;ListView</span>
        <span class="na">android:layout_width=</span><span class="s">&quot;match_parent&quot;</span>
        <span class="na">android:layout_height=</span><span class="s">&quot;match_parent&quot;</span>
        <span class="na">android:id=</span><span class="s">&quot;@+id/main_list_view&quot;</span>
        <span class="na">android:cacheColorHint=</span><span class="s">&quot;@color/deepPurple1&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/ListView&gt;</span>

<span class="nt">&lt;/LinearLayout&gt;</span></code></pre></figure>

<h1 id="display-image-layout"><code>Display Image Layout</code></h1>
<ul>
  <li>Use TableRow to position the two buttons in a row and each button fill half of its parent width.</li>
  <li>Description text is positioned on top of the screen, with transparent background.</li>
</ul>

<p>Transparency colors:</p>

<p>Hex Opacity Values:</p>

<ul>
  <li>100% — FF</li>
  <li>95%  — F2</li>
  <li>90%  — E6</li>
  <li>85%  — D9</li>
  <li>80%  — CC</li>
  <li>75%  — BF</li>
  <li>70%  — B3</li>
  <li>65%  — A6</li>
  <li>60%  — 99</li>
  <li>55%  — 8C</li>
  <li>50%  — 80</li>
  <li>45%  — 73</li>
  <li>40%  — 66</li>
  <li>35%  — 59</li>
  <li>30%  — 4D</li>
  <li>25%  — 40</li>
  <li>20%  — 33</li>
  <li>15%  — 26</li>
  <li>10%  — 1A</li>
  <li>5%   — 0D</li>
  <li>0%   — 00</li>
</ul>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;RelativeLayout</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
                <span class="na">xmlns:tools=</span><span class="s">&quot;http://schemas.android.com/tools&quot;</span>
                <span class="na">android:layout_width=</span><span class="s">&quot;match_parent&quot;</span>
                <span class="na">android:layout_height=</span><span class="s">&quot;match_parent&quot;</span>
                <span class="na">android:orientation=</span><span class="s">&quot;vertical&quot;</span>
                <span class="na">tools:context=</span><span class="s">&quot;com.junjunguo.sqliteimage.DisplayImage&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;ImageView</span>
        <span class="na">android:id=</span><span class="s">&quot;@+id/display_image_view&quot;</span>
        <span class="na">android:layout_width=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="na">android:layout_centerInParent=</span><span class="s">&quot;true&quot;</span>
        <span class="na">android:padding=</span><span class="s">&quot;5dp&quot;</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;TextView</span>
        <span class="na">android:id=</span><span class="s">&quot;@+id/text_view_description&quot;</span>
        <span class="na">android:layout_width=</span><span class="s">&quot;fill_parent&quot;</span>
        <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="na">android:layout_gravity=</span><span class="s">&quot;top&quot;</span>
        <span class="na">android:gravity=</span><span class="s">&quot;center&quot;</span>
        <span class="na">android:textColor=</span><span class="s">&quot;@color/white&quot;</span>
        <span class="na">android:background=</span><span class="s">&quot;#809575CD&quot;</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;TableRow</span>
        <span class="na">android:id=</span><span class="s">&quot;@+id/table_row&quot;</span>
        <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="na">android:layout_width=</span><span class="s">&quot;fill_parent&quot;</span>
        <span class="na">android:weightSum=</span><span class="s">&quot;2&quot;</span>
        <span class="na">android:layout_alignParentBottom=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>

        <span class="nt">&lt;Button</span>
            <span class="na">android:onClick=</span><span class="s">&quot;btnDeleteOnClick&quot;</span>
            <span class="na">android:layout_weight=</span><span class="s">&quot;1&quot;</span>
            <span class="na">android:layout_height=</span><span class="s">&quot;50dp&quot;</span>
            <span class="na">android:background=</span><span class="s">&quot;@color/deepPurple4&quot;</span>
            <span class="na">android:textColor=</span><span class="s">&quot;@color/white&quot;</span>
            <span class="na">android:layout_marginRight=</span><span class="s">&quot;1dp&quot;</span>
            <span class="na">android:id=</span><span class="s">&quot;@+id/btnDelete&quot;</span>
            <span class="na">android:text=</span><span class="s">&quot;Delete&quot;</span><span class="nt">/&gt;</span>

        <span class="nt">&lt;Button</span>
            <span class="na">android:onClick=</span><span class="s">&quot;btnBackOnClick&quot;</span>
            <span class="na">android:layout_weight=</span><span class="s">&quot;1&quot;</span>
            <span class="na">android:layout_height=</span><span class="s">&quot;50dp&quot;</span>
            <span class="na">android:background=</span><span class="s">&quot;@color/deepPurple4&quot;</span>
            <span class="na">android:textColor=</span><span class="s">&quot;@color/white&quot;</span>
            <span class="na">android:layout_marginLeft=</span><span class="s">&quot;1dp&quot;</span>
            <span class="na">android:id=</span><span class="s">&quot;@+id/btnBack&quot;</span>
            <span class="na">android:text=</span><span class="s">&quot;Back&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/TableRow&gt;</span>
<span class="nt">&lt;/RelativeLayout&gt;</span></code></pre></figure>

<h1 id="custom-dialog-layout"><code>Custom dialog Layout</code></h1>

<p><code>layout/custom_dialog_box.xml</code> defines the outlook of Alert Dialog window, which contains:</p>

<ul>
  <li>take photo button</li>
  <li>choose image from gallery button</li>
  <li>and an exit button</li>
</ul>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;RelativeLayout</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
                <span class="na">android:layout_width=</span><span class="s">&quot;fill_parent&quot;</span>
                <span class="na">android:background=</span><span class="s">&quot;@color/deepPurple5&quot;</span>
                <span class="na">android:paddingLeft=</span><span class="s">&quot;@dimen/activity_horizontal_margin&quot;</span>
                <span class="na">android:paddingRight=</span><span class="s">&quot;@dimen/activity_horizontal_margin&quot;</span>
                <span class="na">android:paddingTop=</span><span class="s">&quot;@dimen/activity_vertical_margin&quot;</span>
                <span class="na">android:paddingBottom=</span><span class="s">&quot;@dimen/activity_vertical_margin&quot;</span>
                <span class="na">android:layout_height=</span><span class="s">&quot;fill_parent&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;Button</span>
        <span class="na">android:onClick=</span><span class="s">&quot;btnChoosePathClicked&quot;</span>
        <span class="na">android:id=</span><span class="s">&quot;@+id/btnChoosePath&quot;</span>
        <span class="na">android:background=</span><span class="s">&quot;@color/deepPurple1&quot;</span>
        <span class="na">android:textColor=</span><span class="s">&quot;@color/deepPurple5&quot;</span>
        <span class="na">android:layout_centerHorizontal=</span><span class="s">&quot;true&quot;</span>
        <span class="na">android:layout_width=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="na">android:layout_marginBottom=</span><span class="s">&quot;20dp&quot;</span>
        <span class="na">android:width=</span><span class="s">&quot;200dp&quot;</span>
        <span class="na">android:text=</span><span class="s">&quot;From Gallery&quot;</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;Button</span>
        <span class="na">android:onClick=</span><span class="s">&quot;btnTakePhotoClicked&quot;</span>
        <span class="na">android:id=</span><span class="s">&quot;@+id/btnTakePhoto&quot;</span>
        <span class="na">android:background=</span><span class="s">&quot;@color/deepPurple2&quot;</span>
        <span class="na">android:textColor=</span><span class="s">&quot;@color/deepPurple5&quot;</span>
        <span class="na">android:layout_centerHorizontal=</span><span class="s">&quot;true&quot;</span>
        <span class="na">android:layout_below=</span><span class="s">&quot;@id/btnChoosePath&quot;</span>
        <span class="na">android:layout_width=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="na">android:layout_marginBottom=</span><span class="s">&quot;20dp&quot;</span>
        <span class="na">android:width=</span><span class="s">&quot;200dp&quot;</span>
        <span class="na">android:text=</span><span class="s">&quot;Take Photo&quot;</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;Button</span>
        <span class="na">android:onClick=</span><span class="s">&quot;btnExitClicked&quot;</span>
        <span class="na">android:id=</span><span class="s">&quot;@+id/btnExit&quot;</span>
        <span class="na">android:background=</span><span class="s">&quot;@color/deepPurple4&quot;</span>
        <span class="na">android:textColor=</span><span class="s">&quot;@color/black&quot;</span>
        <span class="na">android:layout_centerHorizontal=</span><span class="s">&quot;true&quot;</span>
        <span class="na">android:layout_below=</span><span class="s">&quot;@id/btnTakePhoto&quot;</span>
        <span class="na">android:layout_width=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="na">android:width=</span><span class="s">&quot;200dp&quot;</span>
        <span class="na">android:text=</span><span class="s">&quot;Exit&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/RelativeLayout&gt;</span></code></pre></figure>

<h1 id="custom-item-layout"><code>Custom item Layout</code></h1>

<p><code>item_image.xml</code> customize item row in ListView.</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;LinearLayout</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
              <span class="na">android:orientation=</span><span class="s">&quot;horizontal&quot;</span>
              <span class="na">android:background=</span><span class="s">&quot;@color/deepPurple5&quot;</span>
              <span class="na">android:layout_width=</span><span class="s">&quot;match_parent&quot;</span>
              <span class="na">android:layout_height=</span><span class="s">&quot;match_parent&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;ImageView</span>
        <span class="na">android:id=</span><span class="s">&quot;@+id/item_img_icon&quot;</span>
        <span class="na">android:layout_width=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="na">android:src=</span><span class="s">&quot;@drawable/ic_launcher&quot;</span>
        <span class="na">android:padding=</span><span class="s">&quot;5dp&quot;</span>
        <span class="na">android:layout_marginRight=</span><span class="s">&quot;10dp&quot;</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;TextView</span>
        <span class="na">android:id=</span><span class="s">&quot;@+id/item_img_infor&quot;</span>
        <span class="na">android:layout_width=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
        <span class="na">android:text=</span><span class="s">&quot;@string/image_information&quot;</span>
        <span class="na">android:textColor=</span><span class="s">&quot;@color/deepPurple1&quot;</span>
        <span class="na">android:padding=</span><span class="s">&quot;5dp&quot;</span>
        <span class="na">android:layout_marginLeft=</span><span class="s">&quot;10dp&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/LinearLayout&gt;</span></code></pre></figure>

<h1 id="stringsxml"><code>strings.xml</code></h1>
<p>The <code>strings.xml</code> in <code>values</code>:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="nt">&lt;resources&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;app_name&quot;</span><span class="nt">&gt;</span>SqliteImage<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;hello_world&quot;</span><span class="nt">&gt;</span>Hello world!<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;action_settings&quot;</span><span class="nt">&gt;</span>Settings<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;add_image&quot;</span><span class="nt">&gt;</span>Add Image<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;title_activity_display_image&quot;</span><span class="nt">&gt;</span>DisplayImage<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;image_information&quot;</span><span class="nt">&gt;</span>Image Information<span class="nt">&lt;/string&gt;</span>
<span class="nt">&lt;/resources&gt;</span></code></pre></figure>

<h1 id="colorsxml"><code>colors.xml</code></h1>
<p>The deep purple style colors in <code>values/colors.xml</code>:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;resources&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&quot;deepPurple1&quot;</span><span class="nt">&gt;</span>#311B92<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&quot;deepPurple2&quot;</span><span class="nt">&gt;</span>#512DA8<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&quot;deepPurple3&quot;</span><span class="nt">&gt;</span>#673AB7<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&quot;deepPurple4&quot;</span><span class="nt">&gt;</span>#9575CD<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&quot;deepPurple5&quot;</span><span class="nt">&gt;</span>#D1C4E9<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&quot;black&quot;</span><span class="nt">&gt;</span>#000<span class="nt">&lt;/color&gt;</span>
    <span class="nt">&lt;color</span> <span class="na">name=</span><span class="s">&quot;white&quot;</span><span class="nt">&gt;</span>#fff<span class="nt">&lt;/color&gt;</span>
<span class="nt">&lt;/resources&gt;</span></code></pre></figure>

<h1 id="androidmanifestxml"><code>AndroidManifest.xml</code></h1>

<p>in <code>AndroidManifest.xml</code> file set storage permission, and camera feature, set camera required to false if it is not
mandatory to have a camera to run the application.</p>

<p><code>&lt;uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/&gt;</code></p>

<p><code>&lt;uses-feature android:name="android.hardware.camera" android:required="false"/&gt;</code></p>

<p>and for full screen in display image window add:</p>

<p><code>android:theme="@android:style/Theme.NoTitleBar.Fullscreen"</code></p>

<p>AndroidManifest.xml:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
          <span class="na">package=</span><span class="s">&quot;com.junjunguo.sqliteimage&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;uses-feature</span>
        <span class="na">android:name=</span><span class="s">&quot;android.hardware.camera&quot;</span>
        <span class="na">android:required=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;application</span>
        <span class="na">android:allowBackup=</span><span class="s">&quot;true&quot;</span>
        <span class="na">android:icon=</span><span class="s">&quot;@mipmap/ic_launcher&quot;</span>
        <span class="na">android:label=</span><span class="s">&quot;@string/app_name&quot;</span>
        <span class="na">android:theme=</span><span class="s">&quot;@style/AppTheme&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;activity</span>
            <span class="na">android:name=</span><span class="s">&quot;.MainActivity&quot;</span>
            <span class="na">android:label=</span><span class="s">&quot;@string/app_name&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;intent-filter&gt;</span>
                <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.action.MAIN&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.category.LAUNCHER&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/intent-filter&gt;</span>
        <span class="nt">&lt;/activity&gt;</span>
        <span class="nt">&lt;activity</span>
            <span class="na">android:name=</span><span class="s">&quot;.DisplayImage&quot;</span>
            <span class="na">android:label=</span><span class="s">&quot;@string/title_activity_display_image&quot;</span>
            <span class="na">android:theme=</span><span class="s">&quot;@android:style/Theme.NoTitleBar.Fullscreen&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/activity&gt;</span>
    <span class="nt">&lt;/application&gt;</span>

<span class="nt">&lt;/manifest&gt;</span></code></pre></figure>

<h1 id="references">References:</h1>

<ul>
  <li>http://developer.android.com/training/basics/data-storage/databases.html</li>
  <li>http://developer.android.com/reference/android/widget/ArrayAdapter.html</li>
  <li>http://developer.android.com/training/improving-layouts/smooth-scrolling.html</li>
  <li>https://github.com/codepath/android_guides/wiki/Using-an-ArrayAdapter-with-ListView</li>
  <li>http://developer.android.com/training/camera/photobasics.html</li>
  <li>http://developer.android.com/reference/android/media/ThumbnailUtils.html</li>
  <li>http://developer.android.com/training/displaying-bitmaps/load-bitmap.html#load-bitmap</li>
  <li>http://developer.android.com/guide/topics/resources/more-resources.html#Color</li>
</ul>

<p>Source code <a href="https://github.com/junjunguo/android/tree/master/2015/SqliteImage">on Github</a></p>


        
          <div id="disqus_thread"></div><!-- /#disqus_thread -->
          
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'guojunjunsblog'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="/blog/android-take-photo-show-in-list-view-b/" class="btn" title="Android take photo and save to gallery, choose photo from gallery and show in ListView">Previous</a>
      
      
        <a href="/blog/android-sqlite-image-view-b/" class="btn" title="Android ListView Image save data in SQLite Database">Next</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<span>&copy; 2017 <a href="https://junjunguo.github.io" rel="nofollow">  GuoJunjun</a></span>
<div class="social-icons">
    
    
    <a href="http://plus.google.com/+GuoJunjun"
                                      title="GuoJunjun on Google+" target="_blank"><i
        class="fa fa-google-plus-square fa-2x"></i></a>
    <a href="http://linkedin.com/in/guojunjun"
                                   title="GuoJunjun on LinkedIn" target="_blank"><i
        class="fa fa-linkedin-square fa-2x"></i></a>
    
    
    <a href="http://www.flickr.com/photos/guojunjun"
                                 title="GuoJunjun on Flickr" target="_blank"><i
        class="fa fa-flickr fa-2x"></i></a>
    <a href="http://github.com/junjunguo" title="GuoJunjun on Github"
                                 target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
    
    <a href="/feed.xml" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a>
</div><!-- /.social-icons -->
  </footer>
</div><!-- /.footer-wrapper -->

<script type="text/javascript">
  var BASE_URL = '';
</script>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="./assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="./assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl = 
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-49981756-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

	        

</body>
</html>
